<!DOCTYPE html>
<html>
    <head>
        <title>hello react</title>
        <script src="https://unpkg.com/react@16.9.0/umd/react.development.js" ></script>
        <script src="https://unpkg.com/react-dom@16.9.0/umd/react-dom.development.js" ></script>
        <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
        <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
        <link rel="stylesheet" type="text/css" href="Content/main.css">
    </head>
    <body>
        <div id="root">
            <div class="r_header">
                <h1>Resursplanering</h1>
            </div>
            <div class="r_users">
                <div class="r_bpane_s">
                    <div id="searchBar">
                        <input type="text" />
                        <button>Search</button>
                    </div>
                </div>
                <div class="r_bpane_l">
                    <div class="u_box-add" id="add-user">
                        <h1>+</h1>
                    </div> 
                </div>
            </div>
            <div class="r_table">
                <div class="r_bpane_s">
                   <div class="t_row-add">
                        <span>+</span>
                   </div>        
                </div>
                <div class="r_bpane_l">
                    <div class="t_col">

                    </div>
                    <div class="t_col">
  
                    </div>
                    <div class="t_col">

                    </div>       
                </div>
            </div>
        </div>   
        <script type="text/babel">
        class Users extends React.Component{
            constructor() {
                super();
                this.state = {
                userList: []
                };
            }
            
            componentWillMount1() {
                axios.get('data.json') // JSON File Path
                .then( response => {
                    this.setState({
                    userList: response.data
                });
                })
                .catch(function (error) {
                    console.log(error);
                });
            }
            
            render() {
                const usersList = this.state.userList;
                let usersListBlock = '';
                
                if(usersList.length > 0) {
                    usersListBlock = usersList.map( obj => {
                    return (
                        <Usercard key={obj.id} id={obj.id} imgPath={obj.avatar_url} name={obj.name} />
                            )
                    })
                }
                
                return(
                    <div className="row container">
                        {usersListBlock}
                    </div>
                )
            }   
        }

        let ucounter = 0;
        let tcounter = 0;
        let cc = 0;
        class Form extends React.Component {
                constructor() {
                super();

                this.displayDataU = [];
                this.displayDataT = [];
                this.displayDataInputs = [];

                this.state = {
                    showuserdata : this.displayDataU,
                    showtopicdata : this.displayDataT,
                    showinputdata : this.displayDataInputs,
                    postVal : "Lärare"
                }

                this.appendData = this.appendData.bind(this);
                this.handleChange = this.handleChange.bind(this);
            };

            appendData(prop) {
                if(prop === "AppendUser"){
                    this.setState({
                        showdata : this.displayDataU,
                        postVal : "Lärare"
                    });
                    const ids = "display-data" + ucounter++;

                    if(ucounter < 8){
                        
                        this.displayDataU.push(
                            <div key={ids} id="display-data" className="u_box">
                                <img src="Images/Sed-01-512.png" />
                                <span>{this.state.postVal}</span>
                                </div>);

                        let rows = [];    
                        for(let i = 0; i < tcounter; ++i){
                            rows.push(<div key={"trow"+i} className="t_crow">
                                        <input className="t_cell" type="number" />
                                        <input className="t_cell" type="number" />
                                        <input className="t_cell" type="number" />
                                        <input className="t_cell" type="number" /> 
                                     </div>);
                        }       
                        this.displayDataInputs.push(
                            <div key={"inputRow_"+cc++} id="display-input-data" className="t_col">                                
                                {rows}
                            </div>
                        );
                    }
                }
                if(prop === "AppendTopic"){
                    this.setState({
                        showdata : this.displayDataU
                    });

                    const ids = "display-data" + tcounter++;

                    if(tcounter < 20){
                        this.displayDataT.push(
                            <div key={ids} id="display-data" className="t_row">Kursnamn</div>
                            );
                    }
                }
            }


            handleChange(e) {
   
                let getTextAreaValue = e.target.value;
                this.setState({
                    postVal :getTextAreaValue
                });
            }

            render() {
                return (
                    <div>
                        <div className="r_header">
                            <h1>Resursplanering</h1>
                        </div>
                        <div className="r_users">
                            <div className="r_bpane_s">
                                <div id="searchBar">
                                    <input type="text" />
                                    <button>Search</button>
                                </div>
                            </div>
                            <div className="r_bpane_l">
                                <div id="display-data-UserContainer">
                                    {this.displayDataU}
                                </div>
                                <div className="u_box-add" id="add-user" onClick={() => this.appendData("AppendUser")}>
                                    <h1>+</h1>
                                </div> 
                            </div>
                        </div>
                        <div className="r_table">
                            <div className="r_bpane_s">
                                <div id="display-data-TopicContainer">
                                    {this.displayDataT}
                                </div>
                                <div className="t_row-add" id="add-topic" onClick={() => this.appendData("AppendTopic")}>
                                        <span>+</span>
                                </div>        
                            </div>
                            <div className="r_bpane_l">
                                <div id="display-data-InputsContainer">
                                    {this.displayDataInputs}
                                </div>           
                            </div>
                        </div>
                    </div>
                );
            }
        }
        ReactDOM.render(<div>
            <Users/>
            <Form/>
        </div>
        , document.getElementById('root'));
        </script>
    </body>
</html>