<!DOCTYPE html>
<html>
    <head>
        <title>Hello React</title>
        <script src="https://unpkg.com/react@16.9.0/umd/react.development.js"></script>
        <script src="https://unpkg.com/react-dom@16.9.0/umd/react-dom.development.js"></script>
        <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
        <script src="resursering.js"></script>
        <link rel="stylesheet" type="text/css" href="main.css" />
    </head>
    <body>
            
        <div id="demo">Ursprunglig text</div>
        <div id="test">Test text</div>
        <script type="text/babel">
            console.log(json);

            function loopLarare(props) {
                // Create array
                var array2 = [];
                for(var i = 0; i <= json.Personal.length-1; i++){
                    array2.push(i);
                }

                const map2 = array2.map((x,i) => Larare(json.Personal[x],i));
                return(map2);
            }

            function Larare(props,index){
                return(
                    <option key={"larare"+index} value="larare">{props.Förnamn} {props.Efternamn}</option>
                )
            }            

            function SelectView(props){       //Filtrering enligt arbetare, kurser eller forskning
                return (
                    <>
                        <div className="options">
                        <h1>Kursverktyg</h1>
                        <select id="input" onChange={(evt) => changeLarare(evt.currentTarget)}>
                            <option value="" defaultValue>Välj input</option>
                            {loopLarare()}
                            <Larare />
                        </select>
                        </div>    
                    </>
                );
            }

            function changeLarare(select) {
                console.log(select.options[select.selectedIndex].text);
            }
            
            function Kurs(props){ //För att skapa en kurs
                return(
                    <tr key={props.namn}>
                        <td contentEditable="true">{props.namn}</td>
                        <td contentEditable="true">{props.timmar}</td>
                        <td contentEditable="true">{props.period}</td>
                    </tr>
                );
            }
        
            function loopKurser(props) {
                // Create array
                var array1 = [];
                for(var i = 0; i <= json.Program.IA.Kurser.length-1; i++){
                    array1.push(i);
                }
                if(props.Förnamn !== undefined){
                    var kurser = personalData.Personal.filter(item => item.Person.Förnamn === props.Förnamn && item.Person.Efternamn === props.Efternamn);
                    if(kurser.length > 0){
                        const IAKurser = kurser.map(x => x.Kurser)[0].IA.map(x => Kurs(x));
                        return(IAKurser);
                    }
                }
                return(null);
            }

            function DisplayResults(props) {
                return(
                    <table>
                        <thead>
                            <tr>
                                <th>{json.Personal[0].Förnamn} (exempel)</th>
                                <th>{json.Personal[0].Efternamn} (exempel)</th>
                                <th>Placeholder</th>
                            </tr>
                        </thead>
                        <tbody>
                            {loopKurser()}
                            <Kurs />
                        </tbody>
                    </table>
                )          
            }
            
            class App extends React.Component{
                constructor(props){
                    super(props);
                    this.state = {
                        key: 0,
                        Person: {}
                    }  
                    this.handleChange = this.handleChange.bind(this);
                    this.handleClick = this.handleClick.bind(this);
                }

                handleChange(props){
                    let randomID = Math.floor(Math.random() * 999999);
                    let name = props.options[props.selectedIndex].text.split(" ");
                    let newPerson = json.Personal.filter(x => x.Förnamn === name[0] && x.Efternamn === name[1])[0];
                    this.setState({
                        Person: newPerson
                    });

                }
                handleClick(){

                }

                render(){
                    return(
                        <div>                   
                            <>
                                <div className="options">
                                    <h1>Kursverktyg</h1>
                                    <select id="input" onChange={(evt) => this.handleChange(evt.currentTarget)}>
                                        <option value="" defaultValue>Välj input</option>
                                        {loopLarare()}
                                        <Larare />
                                    </select>
                                </div>    
                            </>
                            <table>
                                <thead>
                                    <tr>
                                        <th>{this.state.Person.Förnamn} (exempel)</th>
                                        <th>{this.state.Person.Efternamn} (exempel)</th>
                                        <th>Placeholder</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {loopKurser(this.state.Person)}
                                    <Kurs />
                                </tbody>
                            </table>
                            
                        </div> 
                    );
                }
            }
            ReactDOM.render(                              
                <App />,
                document.getElementById("demo") 
            );
        </script>
    </body>
</html>